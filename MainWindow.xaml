<Window x:Class="FACTOVA_LogAnalysis.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:views="clr-namespace:FACTOVA_LogAnalysis.Views"
        mc:Ignorable="d"
        Title="FACTOVA Log Analysis" Height="800" Width="1600" WindowState="Maximized">
    <Window.Resources>
        <Style x:Key="GridCellStyle" TargetType="DataGridCell">
            <Setter Property="BorderBrush" Value="LightGray"/>
            <Setter Property="BorderThickness" Value="0.5"/>
            <Setter Property="Padding" Value="4,2"/>
        </Style>
        <Style x:Key="GridHeaderStyle" TargetType="DataGridColumnHeader">
            <Setter Property="BorderBrush" Value="LightGray"/>
            <Setter Property="BorderThickness" Value="0.5"/>
            <Setter Property="Padding" Value="6,4"/>
            <Setter Property="Background" Value="WhiteSmoke"/>
        </Style>

        <!-- Content 컬럼 스타일: 고정 높이 + 내부 스크롤 + 복사 가능 -->
        <Style x:Key="ContentCellStyle" TargetType="DataGridCell">
            <Setter Property="BorderBrush" Value="LightGray"/>
            <Setter Property="BorderThickness" Value="0.5"/>
            <Setter Property="Padding" Value="0"/>
            <Setter Property="FocusVisualStyle" Value="{x:Null}"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="DataGridCell">
                        <Border BorderBrush="{TemplateBinding BorderBrush}" 
                                BorderThickness="{TemplateBinding BorderThickness}"
                                Background="White">
                            <ScrollViewer VerticalScrollBarVisibility="Auto" 
                                          HorizontalScrollBarVisibility="Auto"
                                          MaxHeight="100"
                                          Focusable="False">
                                <TextBox Text="{Binding Content, Mode=OneWay}"
                                         IsReadOnly="True"
                                         BorderThickness="0"
                                         Background="Transparent"
                                         Foreground="Black"
                                         TextWrapping="Wrap"
                                         Margin="4,2"
                                         Padding="0"
                                         VerticalAlignment="Top"
                                         FontFamily="Consolas"
                                         AcceptsReturn="True"
                                         Cursor="Arrow"
                                         IsReadOnlyCaretVisible="False"
                                         Focusable="True"
                                         IsTabStop="False"
                                         SelectionBrush="#3399FF"
                                         SelectionTextBrush="White"
                                         SelectionOpacity="0.4"
                                         PreviewMouseLeftButtonDown="ContentTextBox_PreviewMouseLeftButtonDown"/>
                            </ScrollViewer>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Global DataGrid style so all DataGrids get full grid lines and the cell/header styles -->
        <Style TargetType="DataGrid">
            <Setter Property="GridLinesVisibility" Value="All" />
            <Setter Property="CellStyle" Value="{StaticResource GridCellStyle}" />
            <Setter Property="ColumnHeaderStyle" Value="{StaticResource GridHeaderStyle}" />
        </Style>
    </Window.Resources>

    <Grid Margin="5">
        <TabControl Grid.Row="0" Margin="5" Name="mainTabControl">
            <TabItem Header="Log Analysis" Name="mainLogTb">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" Name="RibbonRowDefinition"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- Top Controls -->
                    <Expander Grid.Row="0" Name="RibbonExpander" Header="FACTOVA Log 분석" IsExpanded="True" 
                          Background="AliceBlue" BorderBrush="SteelBlue" BorderThickness="1" Margin="0,0,0,5">
                        <Grid Margin="10">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <!-- Log Folder Settings -->
                            <GroupBox Grid.Row="0" Header="폴더 설정" Margin="0,0,0,10" 
                                  Background="White" BorderBrush="LightSteelBlue">
                                <StackPanel Orientation="Vertical" Margin="10,5">
                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,5">
                                        <Button Name="OpenFolderButton" Content="폴더 열기" Width="100" Height="30"  
                                            Click="OpenFolder_Click" ToolTip="Open Log Folder" Background="Khaki"/>
                                        <TextBox Name="LogFolderPathTextBox" Margin="5,0" VerticalAlignment="Center" 
                                             IsReadOnly="True" TextWrapping="NoWrap" Width="500"
                                             ToolTip="Current log folder path" 
                                             BorderBrush="LightGray" Background="LightGray" Height="30" FontSize="16"/>
                                        <Button Name="ChangeFolderButton" Content="폴더 변경" Width="80" Margin="5,0" 
                                            Click="ChangeFolderButton_Click" ToolTip="Change log folder"
                                            Background="LightSteelBlue" Foreground="DarkBlue"/>
                                        <Button Name="ResetFolderPathButton" Content="내문서 경로" Width="80" Margin="5,0,0,0" 
                                            Click="ResetFolderPathButton_Click" 
                                            ToolTip="Reset log folder path to default" 
                                            Background="LightCoral" Foreground="White"/>

                                        <Button Name="OpenNotepadButton" Content="메모장 열기" Width="80" Height="30" Margin="5,0" 
                                            Click="OpenNotepad_Click" ToolTip="Open Notepad" Background="Khaki"/>
                                        <!-- Button to open log folder in VS Code -->
                                        <Button Name="OpenInVSCodeButton" Content="VSCode로 폴더 열기" Width="120" Height="30" Margin="0,0,5,0"
                                            Click="OpenInVSCodeButton_Click" ToolTip="Open log folder in Visual Studio Code" Background="LightSlateGray" Foreground="White"/>
                                        <!-- Help Button -->
                                        <Button Name="ShowHelpButton" Content="📚 도움말" Width="90" Height="30" Margin="0,0,0,0"
                                            Click="ShowHelp_Click" ToolTip="프로그램 사용 도움말" Background="LightSkyBlue" Foreground="DarkBlue" FontWeight="SemiBold"/>
                                    </StackPanel>
                                    <!-- Load Options (moved here without SubmitButton) -->
                                    <StackPanel Orientation="Horizontal" Margin="0,2,0,0">
                                        <Label Content="Load Options:" VerticalAlignment="Center" FontWeight="SemiBold"/>
                                        <CheckBox Name="LoadTextCheckBox" Content="📝 Text" VerticalAlignment="Center" Margin="5,0" IsChecked="False" 
                                              ToolTip="Load logs in text format" 
                                              Checked="LoadTextCheckBox_CheckedChanged" 
                                              Unchecked="LoadTextCheckBox_CheckedChanged"/>
                                        <CheckBox Name="LoadDataGridCheckBox" Content="📊 DataGrid" VerticalAlignment="Center" Margin="5,0" IsChecked="True" 
                                              ToolTip="Load logs in DataGrid format"
                                              Checked="LoadDataGridCheckBox_CheckedChanged" 
                                              Unchecked="LoadDataGridCheckBox_CheckedChanged"/>
                                    </StackPanel>
                                </StackPanel>
                            </GroupBox>

                            <!-- Search and Filter Settings -->
                            <GroupBox Grid.Row="1" Header="조회 조건" 
                                  Background="White" BorderBrush="LightSteelBlue">
                                <Grid Margin="10,5">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>

                                    <!-- Single row: Date + Time + Search + Search Mode -->
                                    <StackPanel Grid.Row="0" Orientation="Horizontal">
                                        <Label Content="일자 :" VerticalAlignment="Center" FontWeight="SemiBold"/>
                                        <!-- Date selector: either DatePicker (default) or ComboBox (when custom log folder) -->
                                        <ComboBox Name="dateComboBox" Width="100" Height="25" Margin="5,0,8,0" VerticalAlignment="Center" 
                                                ToolTip="Select date from log files" IsEditable="False" SelectionChanged="DateComboBox_SelectionChanged" />

                                        <!-- Time Range Filter with ComboBox presets -->
                                        <ComboBox Name="timePresetComboBox" Width="70" Height="25" Margin="0,0,4,0" VerticalAlignment="Center"
                                             ToolTip="Select time preset" SelectionChanged="TimePresetComboBox_SelectionChanged">
                                            <ComboBoxItem Content="종일" Tag="00:00~23:59"/>
                                            <ComboBoxItem Content="오전" Tag="08:00~12:59"/>
                                            <ComboBoxItem Content="오후" Tag="13:00~16:59"/>
                                            <ComboBoxItem Content="잔업" Tag="17:30~20:30"/>
                                            <ComboBoxItem Content="07시" Tag="07:00~07:59"/>
                                            <ComboBoxItem Content="08시" Tag="08:00~08:59"/>
                                            <ComboBoxItem Content="09시" Tag="09:00~09:59"/>
                                            <ComboBoxItem Content="10시" Tag="10:00~10:59"/>
                                            <ComboBoxItem Content="11시" Tag="11:00~11:59"/>
                                            <ComboBoxItem Content="12시" Tag="12:00~12:59"/>
                                            <ComboBoxItem Content="13시" Tag="13:00~13:59"/>
                                            <ComboBoxItem Content="14시" Tag="14:00~14:59"/>
                                            <ComboBoxItem Content="15시" Tag="15:00~15:59"/>
                                            <ComboBoxItem Content="16시" Tag="16:00~16:59"/>
                                            <ComboBoxItem Content="17시" Tag="17:00~17:59"/>
                                            <ComboBoxItem Content="18시" Tag="18:00~18:59"/>
                                            <ComboBoxItem Content="19시" Tag="19:00~19:59"/>
                                            <ComboBoxItem Content="20시" Tag="20:00~20:59"/>
                                            <ComboBoxItem Content="21시" Tag="21:00~21:59"/>
                                            <ComboBoxItem Content="22시" Tag="22:00~22:59"/>
                                            <ComboBoxItem Content="23시" Tag="23:00~23:59"/>
                                            <ComboBoxItem Content="00시" Tag="00:00~00:59"/>
                                            <ComboBoxItem Content="01시" Tag="01:00~01:59"/>
                                            <ComboBoxItem Content="02시" Tag="02:00~02:59"/>
                                            <ComboBoxItem Content="03시" Tag="03:00~03:59"/>
                                            <ComboBoxItem Content="04시" Tag="04:00~04:59"/>
                                            <ComboBoxItem Content="05시" Tag="05:00~05:59"/>
                                            <ComboBoxItem Content="06시" Tag="06:00~06:59"/>
                                        </ComboBox>

                                        <TextBox Name="fromTimeTextBox" Width="50" Height="25" Margin="0,0,4,0" VerticalAlignment="Center" 
                                             ToolTip="From time (HH:MM format)" Text="00:00" MaxLength="5" FontSize="14"/>
                                        <TextBlock Text="~" VerticalAlignment="Center" FontWeight="SemiBold" Margin="0,0,4,0"/>
                                        <TextBox Name="toTimeTextBox" Width="50" Height="25" Margin="0,0,12,0" VerticalAlignment="Center" 
                                             ToolTip="To time (HH:MM format)" Text="23:59" MaxLength="5" FontSize="14"/>

                                        <Separator Margin="6,0"/>

                                        <!-- Search and mode on same line -->
                                        <Label Content="검색어 :" VerticalAlignment="Center" FontWeight="SemiBold" Margin="6,0,4,0"/>
                                        <TextBox Name="searchTextBox" Width="180" VerticalAlignment="Center" Margin="0,0,12,0" Height="25"/>
                                        <Label Content="검색어 범위 :" VerticalAlignment="Center" FontWeight="SemiBold" Margin="0,0,4,0"/>
                                        <ComboBox Name="searchModeComboBox" Width="100" Height="25" Margin="0,0,8,0" VerticalAlignment="Center" 
                                              ToolTip="Select search mode">
                                            <ComboBoxItem Content="처음과 끝" Tag="Range" ToolTip="Show range around search text"/>
                                            <ComboBoxItem Content="검색어 이전" Tag="Before" ToolTip="Show all logs before first match"/>
                                            <ComboBoxItem Content="검색어 이후" Tag="After" ToolTip="Show all logs after first match"/>
                                        </ComboBox>
                                        <!-- Moved main Submit button here so it's next to search controls -->
                                        <Button Name="SubmitButton" Content="🚀 불러오고 시각화" Width="140" Margin="8,0,0,0" 
                                            Click="SubmitButton_Click" Background="LightGreen" Foreground="DarkGreen" FontWeight="SemiBold"
                                            ToolTip="Load logs according to selected options"/>
                                        <!-- 진행 시간 표시 (테스트용으로 항상 보이게) -->
                                        <TextBlock Name="LoadProgressTextBlock" Text="" VerticalAlignment="Center" Margin="10,0,0,0" 
                                               FontWeight="Bold" FontSize="16" Foreground="Red" Visibility="Visible"/>
                                    </StackPanel>
                                </Grid>
                            </GroupBox>
                        </Grid>
                    </Expander>

                    <!-- Main Content - TabControl -->
                    <TabControl Grid.Row="1" Margin="5" Name="LogTabControl">

                        <!-- Tab 1: SFC Log (Text) with Format Toolbar -->
                        <TabItem Header="📝 SFC Log (Text)" Name="LogAnalysisTab">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>

                                <!-- Format Toolbar - Only for Text Tab -->
                                <Border Grid.Row="0" Background="AliceBlue" BorderBrush="SteelBlue" BorderThickness="0,0,0,1" Padding="8,6">
                                    <StackPanel Orientation="Horizontal" Margin="10,5">
                                        <!-- Font Size Group -->
                                        <Label Content="Font Size:" VerticalAlignment="Center" FontWeight="SemiBold" Margin="0,0,5,0"/>
                                        <TextBox Name="FontSizeTextBox" Width="40" Height="25" Text="14" TextAlignment="Center" VerticalContentAlignment="Center" IsReadOnly="True" Margin="0,0,5,0"/>
                                        <Button Name="FontSizeDecreaseButton" Content="🔤-" Width="35" Height="25" Margin="0,0,2,0" Click="FontSizeDecrease_Click" ToolTip="Decrease Font Size"/>
                                        <Button Name="FontSizeIncreaseButton" Content="🔤+" Width="35" Height="25" Margin="0,0,10,0" Click="FontSizeIncrease_Click" ToolTip="Increase Font Size"/>

                                        <Separator Margin="5,0"/>

                                        <Button Name="ApplyFontSizeButton" Content="개별 변경" Width="70" Height="25" Margin="0,0,10,0" Click="ApplyFontSizeButton_Click" ToolTip="Apply entered font size to text logs"/>
                                        <Button Name="ApplyAllFontSizesButton_TextTab" Content="전체 변경" Width="70" Height="25" Margin="0,0,10,0" Click="ApplyAllFontSizesButton_Click" ToolTip="Apply both Text and DataGrid font sizes"/>
                                        <!-- Toggle between 4-panel and tab view for Text tab -->
                                        <Button Name="ToggleTextViewModeButton" Content="탭으로 전환" Width="120" Height="25" Margin="0,0,10,0" Click="ToggleTextViewModeButton_Click" ToolTip="Toggle Text view between 4-panel and tab view" Background="LightSteelBlue" Foreground="DarkBlue"/>

                                        <!-- Color Group -->
                                        <!-- removed Text Color and Text Tools controls as requested -->
                                    </StackPanel>
                                </Border>

                                <!-- 4-Panel Log Display with GridSplitters -->
                                <Grid Grid.Row="1" Name="TextFourPanel">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" Name="LeftColumnDefinition"/>
                                        <ColumnDefinition Width="3"/>
                                        <ColumnDefinition Width="*" Name="RightColumnDefinition"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="*" Name="TopRowDefinition"/>
                                        <RowDefinition Height="3"/>
                                        <RowDefinition Height="*" Name="BottomRowDefinition"/>
                                    </Grid.RowDefinitions>

                                    <!-- DATA Section -->
                                    <GroupBox Grid.Column="0" Grid.Row="0" Margin="5" Name="DataGroupBox">
                                        <GroupBox.Header>
                                            <TextBlock Text="📊 DATA" VerticalAlignment="Center" FontWeight="Bold" FontSize="12" Foreground="DarkBlue" Margin="0,0,10,0"/>
                                        </GroupBox.Header>
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="50"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>

                                            <TextBox Grid.Column="0" Name="dataLineNumberTextBox" 
                                         IsReadOnly="True" 
                                         VerticalScrollBarVisibility="Hidden" 
                                         HorizontalScrollBarVisibility="Hidden" 
                                         Background="LightGray" 
                                         FontFamily="Consolas" 
                                         FontSize="14" 
                                         Padding="5,0" 
                                         TextAlignment="Right"
                                         BorderThickness="0,0,1,0"
                                         BorderBrush="Gray"/>

                                            <TextBox Grid.Column="1" Name="dataLogTextBox"
                                         IsReadOnly="True"
                                         VerticalScrollBarVisibility="Visible" 
                                         HorizontalScrollBarVisibility="Auto" 
                                         KeyDown="LogTextBox_KeyDown" 
                                         GotFocus="LogTextBox_GotFocus" 
                                         FontFamily="Consolas" 
                                         FontSize="14"
                                         TextWrapping="NoWrap"
                                         AcceptsReturn="True"
                                         ScrollViewer.ScrollChanged="TextBox_ScrollChanged"
                                         Background="White"/>
                                        </Grid>
                                    </GroupBox>

                                    <!-- Vertical GridSplitter -->
                                    <GridSplitter Grid.Column="1" Grid.Row="0" Grid.RowSpan="3"
                                      HorizontalAlignment="Stretch"
                                      VerticalAlignment="Stretch"
                                      Width="5"
                                      Background="#FF6B6B6B"
                                      ShowsPreview="True"
                                      ResizeBehavior="PreviousAndNext"
                                      Cursor="SizeWE"/>

                                    <!-- EVENT Section -->
                                    <GroupBox Grid.Column="2" Grid.Row="0" Margin="5" Name="EventGroupBox">
                                        <GroupBox.Header>
                                            <TextBlock Text="📅 EVENT" VerticalAlignment="Center" FontWeight="Bold" FontSize="12" Foreground="DarkGreen"/>
                                        </GroupBox.Header>
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="50"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>

                                            <TextBox Grid.Column="0" Name="eventLineNumberTextBox" 
                                         IsReadOnly="True" 
                                         VerticalScrollBarVisibility="Hidden" 
                                         HorizontalScrollBarVisibility="Hidden" 
                                         Background="LightGray" 
                                         FontFamily="Consolas" 
                                         FontSize="14" 
                                         Padding="5,0" 
                                         TextAlignment="Right"
                                         BorderThickness="0,0,1,0"
                                         BorderBrush="Gray"/>

                                            <TextBox Grid.Column="1" Name="eventLogTextBox"
                                         IsReadOnly="True"
                                         VerticalScrollBarVisibility="Visible" 
                                         HorizontalScrollBarVisibility="Auto" 
                                         KeyDown="LogTextBox_KeyDown" 
                                         GotFocus="LogTextBox_GotFocus" 
                                         FontFamily="Consolas" 
                                         FontSize="14"
                                         TextWrapping="NoWrap"
                                         AcceptsReturn="True"
                                         ScrollViewer.ScrollChanged="TextBox_ScrollChanged"
                                         Background="White"/>
                                        </Grid>
                                    </GroupBox>

                                    <!-- Horizontal GridSplitter -->
                                    <GridSplitter Grid.Column="0" Grid.Row="1" Grid.ColumnSpan="3"
                                      HorizontalAlignment="Stretch"
                                      VerticalAlignment="Stretch"
                                      Height="5"
                                      Background="#FF6B6B6B"
                                      ShowsPreview="True"
                                      ResizeBehavior="PreviousAndNext"
                                      Cursor="SizeNS"/>

                                    <!-- DEBUG Section -->
                                    <GroupBox Grid.Column="0" Grid.Row="2" Margin="5" Name="DebugGroupBox">
                                        <GroupBox.Header>
                                            <TextBlock Text="🔧 DEBUG" VerticalAlignment="Center" FontWeight="Bold" FontSize="12" Foreground="DarkOrange"/>
                                        </GroupBox.Header>
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="50"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>

                                            <TextBox Grid.Column="0" Name="debugLineNumberTextBox" 
                                         IsReadOnly="True" 
                                         VerticalScrollBarVisibility="Hidden" 
                                         HorizontalScrollBarVisibility="Hidden" 
                                         Background="LightGray" 
                                         FontFamily="Consolas" 
                                         FontSize="14" 
                                         Padding="5,0" 
                                         TextAlignment="Right"
                                         BorderThickness="0,0,1,0"
                                         BorderBrush="Gray"/>

                                            <TextBox Grid.Column="1" Name="debugLogTextBox"
                                         IsReadOnly="True"
                                         VerticalScrollBarVisibility="Visible" 
                                         HorizontalScrollBarVisibility="Auto" 
                                         KeyDown="LogTextBox_KeyDown" 
                                         GotFocus="LogTextBox_GotFocus" 
                                         FontFamily="Consolas" 
                                         FontSize="14"
                                         TextWrapping="NoWrap"
                                         AcceptsReturn="True"
                                         ScrollViewer.ScrollChanged="TextBox_ScrollChanged"
                                         Background="White"/>
                                        </Grid>
                                    </GroupBox>

                                    <!-- Horizontal GridSplitter between DEBUG and EXCEPTION -->
                                    <GridSplitter Grid.Column="0" Grid.Row="1" Grid.ColumnSpan="3"
                                      HorizontalAlignment="Stretch"
                                      VerticalAlignment="Stretch"
                                      Height="5"
                                      Background="#FF6B6B6B"
                                      ShowsPreview="True"
                                      ResizeBehavior="PreviousAndNext"
                                      Cursor="SizeNS"/>

                                    <!-- EXCEPTION Section -->
                                    <GroupBox Grid.Column="2" Grid.Row="2" Margin="5" Name="ExceptionGroupBox">
                                        <GroupBox.Header>
                                            <TextBlock Text="⚠️ EXCEPTION" VerticalAlignment="Center" FontWeight="Bold" FontSize="12" Foreground="DarkRed"/>
                                        </GroupBox.Header>
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="50"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>

                                            <TextBox Grid.Column="0" Name="exceptionLineNumberTextBox" 
                                         IsReadOnly="True" 
                                         VerticalScrollBarVisibility="Hidden" 
                                         HorizontalScrollBarVisibility="Hidden" 
                                         Background="LightGray" 
                                         FontFamily="Consolas" 
                                         FontSize="14" 
                                         Padding="5,0" 
                                         TextAlignment="Right"
                                         BorderThickness="0,0,1,0"
                                         BorderBrush="Gray"/>

                                            <TextBox Grid.Column="1" Name="exceptionLogTextBox"
                                         IsReadOnly="True"
                                         VerticalScrollBarVisibility="Visible" 
                                         HorizontalScrollBarVisibility="Auto" 
                                         KeyDown="LogTextBox_KeyDown" 
                                         GotFocus="LogTextBox_GotFocus" 
                                         FontFamily="Consolas" 
                                         FontSize="14"
                                         TextWrapping="NoWrap"
                                         AcceptsReturn="True"
                                         ScrollViewer.ScrollChanged="TextBox_ScrollChanged"
                                         Background="White"/>
                                        </Grid>
                                    </GroupBox>
                                </Grid>

                                <!-- Tabbed Text View (hidden by default) -->
                                <TabControl Grid.Row="1" Name="TextTabPanel" Visibility="Collapsed" Margin="2">
                                    <TabItem Header="DATA">
                                        <GroupBox Margin="5">
                                            <GroupBox.Header>
                                                <TextBlock Text="📊 DATA" VerticalAlignment="Center" FontWeight="Bold" FontSize="12" Foreground="DarkBlue" Margin="0,0,10,0"/>
                                            </GroupBox.Header>
                                            <ContentControl Name="TextHost_DATA_Tab" />
                                        </GroupBox>
                                    </TabItem>
                                    <TabItem Header="EVENT">
                                        <GroupBox Margin="5">
                                            <GroupBox.Header>
                                                <TextBlock Text="📅 EVENT" VerticalAlignment="Center" FontWeight="Bold" FontSize="12" Foreground="DarkGreen"/>
                                            </GroupBox.Header>
                                            <ContentControl Name="TextHost_EVENT_Tab" />
                                        </GroupBox>
                                    </TabItem>
                                    <TabItem Header="DEBUG">
                                        <GroupBox Margin="5">
                                            <GroupBox.Header>
                                                <TextBlock Text="🔧 DEBUG" VerticalAlignment="Center" FontWeight="Bold" FontSize="12" Foreground="DarkOrange" Margin="0,0,10,0"/>
                                            </GroupBox.Header>
                                            <ContentControl Name="TextHost_DEBUG_Tab" />
                                        </GroupBox>
                                    </TabItem>
                                    <TabItem Header="EXCEPTION">
                                        <GroupBox Margin="5">
                                            <GroupBox.Header>
                                                <TextBlock Text="⚠️ EXCEPTION" VerticalAlignment="Center" FontWeight="Bold" FontSize="12" Foreground="DarkRed"/>
                                            </GroupBox.Header>
                                            <ContentControl Name="TextHost_EXCEPTION_Tab" />
                                        </GroupBox>
                                    </TabItem>
                                </TabControl>
                            </Grid>
                        </TabItem>

                        <!-- Tab 2: DataGrid Viewer -->
                        <TabItem Header="📊 SFC Log (DataGrid)" Name="DataGridLogTab">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>

                                <!-- Toolbar -->
                                <Border Grid.Row="0" Background="AliceBlue" BorderBrush="SteelBlue" BorderThickness="0,0,0,1" Padding="8,6">
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>

                                        <!-- Row 1: Font size + view controls -->
                                        <Grid Grid.Row="0" Margin="0,0,0,6">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*" />
                                                <ColumnDefinition Width="Auto" />
                                            </Grid.ColumnDefinitions>

                                            <!-- Left side: font size + view controls -->
                                            <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                                                <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="0,0,12,0">
                                                    <Label Content="Font Size:" VerticalAlignment="Center" FontWeight="SemiBold" Margin="0,0,6,0"/>
                                                    <TextBox Name="DataGridFontSizeTextBox" Width="42" Height="26" Text="11" TextAlignment="Center" VerticalContentAlignment="Center" IsReadOnly="True" Margin="0,0,6,0"/>
                                                    <Button Name="DataGridFontSizeDecreaseButton" Content="-" Width="30" Height="26" Margin="0,0,4,0" Click="DataGridFontSizeDecrease_Click" ToolTip="Decrease DataGrid Font Size"/>
                                                    <Button Name="DataGridFontSizeIncreaseButton" Content="+" Width="30" Height="26" Margin="0,0,8,0" Click="DataGridFontSizeIncrease_Click" ToolTip="Increase DataGrid Font Size"/>
                                                    <Button Name="ApplyDataGridFontSizeButton" Content="개별 변경" Width="70" Height="26" Margin="0,0,6,0" Click="ApplyDataGridFontSizeButton_Click" ToolTip="Apply font size to DataGrids"/>
                                                    <Button Name="ApplyAllFontSizesButton" Content="전체 변경" Width="70" Height="26" Margin="0,0,2,0" Click="ApplyAllFontSizesButton_Click" ToolTip="Apply both Text and DataGrid font sizes"/>
                                                </StackPanel>

                                                <Separator VerticalAlignment="Stretch" Width="1" Margin="0,0,12,0"/>

                                                <Button Name="ToggleViewModeButton" Content="탭으로 전환" Width="100" Height="30" Margin="0,0,8,0" 
                                            Click="ToggleViewModeButton_Click" ToolTip="Toggle between 4-panel and 4-tab view"
                                            Background="LightSteelBlue" Foreground="DarkBlue"/>
                                                <Button Name="ToggleAllContentButton" Content="콘텐츠 닫기" Width="100" Height="30" Margin="0,0,8,0" 
                                            Click="ToggleAllContentButton_Click" ToolTip="Toggle Content column visibility"
                                            Background="LightSteelBlue" Foreground="DarkBlue"/>
                                                <Button Name="GoToSameTimeButton" Content="⏱ 동일 시간 이동" Width="110" Height="30" Margin="0,0,0,0"
                                            Click="GoToSameTimeButton_Click" ToolTip="Go to matching time in other DataGrids (use selected row's Time)"
                                            Background="LightYellow" Foreground="DarkBlue"/>
                                            </StackPanel>
                                        </Grid>

                                        <!-- Row 2: Filters and status -->
                                        <StackPanel Grid.Row="1" Orientation="Horizontal" VerticalAlignment="Center">
                                            <Button Name="ClearAllFiltersButton" Content="🔄 필터 초기화" Width="120" Height="28" Margin="0,0,8,0" 
                                        Click="ClearAllFiltersButton_Click" ToolTip="Clear all filters"
                                        Background="LightYellow" Foreground="DarkOrange"/>
                                            <Button Name="ExportDataGridButton" Content="📥 엑셀 다운로드" Width="120" Height="28" Margin="0,0,8,0"
                                        Click="ExportDataGridButton_Click" ToolTip="Export active DataGrid to Excel (CSV)" Background="LightGreen" Foreground="DarkBlue"/>

                                            <Separator Margin="10,0"/>
                                            <TextBlock Name="AllDataGridStatusText" Text="Use main Load button with DataGrid option checked" 
                                           VerticalAlignment="Center" FontWeight="SemiBold" Foreground="DarkBlue" Margin="12,0" FontSize="12" Visibility="Collapsed"/>
                                        </StackPanel>
                                    </Grid>
                                </Border>

                                <!-- 4-Panel DataGrid Area with GridSplitters -->
                                <Grid Grid.Row="1" Name="DataGridFourPanel" Visibility="Visible">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" Name="DataLeftColumnDefinition"/>
                                        <ColumnDefinition Width="3"/>
                                        <ColumnDefinition Width="*" Name="DataRightColumnDefinition"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="*" Name="DataTopRowDefinition"/>
                                        <RowDefinition Height="3"/>
                                        <RowDefinition Height="*" Name="DataBottomRowDefinition"/>
                                    </Grid.RowDefinitions>

                                    <!-- DATA DataGrid -->
                                    <GroupBox Grid.Column="0" Grid.Row="0" Margin="5" Name="DataGroupBox_FourPanel">
                                        <GroupBox.Header>
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock Text="📊 DATA" VerticalAlignment="Center" FontWeight="Bold" FontSize="12" Foreground="DarkBlue" Margin="0,0,10,0"/>
                                                <TextBlock Text="Business:" VerticalAlignment="Center" FontSize="14" FontWeight="SemiBold" Margin="0,0,3,0"/>
                                                <ComboBox Name="DataBusinessFilterComboBox" Width="200" Height="32" FontSize="14" 
                                              ToolTip="Filter DATA logs by business name (Multi-select with checkboxes)" 
                                              Margin="0,0,5,0" Padding="8,5" VerticalContentAlignment="Center"
                                              IsEditable="True"
                                              Text="Select">
                                                    <ComboBox.ItemTemplate>
                                                        <DataTemplate>
                                                            <CheckBox IsChecked="{Binding IsSelected, Mode=TwoWay}"
                                                          Checked="BusinessCheckBox_Checked"
                                                          Unchecked="BusinessCheckBox_Unchecked"
                                                          FontSize="14">
                                                                <TextBlock Text="{Binding Value}"/>
                                                            </CheckBox>
                                                        </DataTemplate>
                                                    </ComboBox.ItemTemplate>
                                                </ComboBox>
                                                <Button Name="ClearDataBusinessFilterButton" Content="🔄" Width="28" Height="30" FontSize="13"
                                            Click="ClearDataBusinessFilterButton_Click" ToolTip="Clear DATA Business filter" Margin="3,0"/>
                                                <TextBlock Text="Content:" VerticalAlignment="Center" FontSize="14" FontWeight="SemiBold" Margin="5,0,3,0"/>
                                                <TextBox Name="DataContentFilterTextBox" Width="150" Height="32" FontSize="14" 
                                             ToolTip="Filter DATA logs by content keywords" 
                                             TextChanged="DataContentFilterTextBox_TextChanged" Padding="8,5" VerticalContentAlignment="Center"
                                             Margin="0,0,5,0"/>
                                                <Button Name="ClearDataContentFilterButton" Content="🔄" Width="28" Height="30" FontSize="13"
                                            Click="ClearDataContentFilterButton_Click" ToolTip="Clear DATA Content filter" Margin="3,0"/>
                                            </StackPanel>
                                        </GroupBox.Header>
                                        <DataGrid Name="dataLogDataGrid" 
                                      AutoGenerateColumns="False"
                                      GridLinesVisibility="All"
                                      HeadersVisibility="Column"
                                      SelectionMode="Extended"
                                      SelectionUnit="FullRow"
                                      CanUserReorderColumns="False"
                                      CanUserSortColumns="True"
                                      CanUserResizeRows="True"
                                      IsReadOnly="False"
                                      VirtualizingPanel.IsVirtualizing="True"
                                      VirtualizingPanel.VirtualizationMode="Recycling"
                                      FontFamily="Consolas"
                                      FontSize="11"
                                      AlternatingRowBackground="WhiteSmoke"
                                      RowBackground="White"
                                      Margin="2"
                                      ScrollViewer.HorizontalScrollBarVisibility="Auto"
                                      ScrollViewer.VerticalScrollBarVisibility="Auto">

                                            <DataGrid.Columns>
                                                <DataGridTextColumn Header="Line" Binding="{Binding LineNumber}" Width="50" IsReadOnly="True"/>
                                                <DataGridTextColumn Header="Time" Binding="{Binding Timestamp}" Width="70" IsReadOnly="False"/>
                                                <DataGridTextColumn Header="Business" Binding="{Binding BusinessName}" Width="250" IsReadOnly="False"/>
                                                <DataGridTextColumn Header="BARCODE/LOT" Binding="{Binding BARCODE_LOT}" Width="150" IsReadOnly="False"/>
                                                <DataGridTextColumn Header="Content" Binding="{Binding Content}" Width="500" IsReadOnly="False" CellStyle="{StaticResource ContentCellStyle}"/>
                                                <DataGridTextColumn Header="ExecTime" Binding="{Binding ExecTime}" Width="90" IsReadOnly="False"/>
                                                <DataGridTextColumn Header="TxnId" Binding="{Binding TxnId}" Width="200" IsReadOnly="False"/>
                                                
                                            </DataGrid.Columns>
                                        </DataGrid>
                                    </GroupBox>

                                    <!-- Vertical GridSplitter for DataGrid -->
                                    <GridSplitter Grid.Column="1" Grid.Row="0" Grid.RowSpan="3"
                                      HorizontalAlignment="Stretch"
                                      VerticalAlignment="Stretch"
                                      Width="5"
                                      Background="#FF6B6B6B"
                                      ShowsPreview="True"
                                      ResizeBehavior="PreviousAndNext"
                                      Cursor="SizeWE"/>

                                    <!-- EVENT DataGrid -->
                                    <GroupBox Grid.Column="2" Grid.Row="0" Margin="5" Name="EventGroupBox_FourPanel">
                                        <GroupBox.Header>
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock Text="📅 EVENT" VerticalAlignment="Center" FontWeight="Bold" FontSize="12" Foreground="DarkGreen" Margin="0,0,10,0"/>
                                                <TextBlock Text="MsgId:" VerticalAlignment="Center" FontSize="14" FontWeight="SemiBold" Margin="0,0,3,0"/>
                                                <ComboBox Name="EventMsgIdFilterComboBox" Width="200" Height="32" FontSize="14" 
                                              ToolTip="Filter EVENT logs by MsgId (Multi-select with checkboxes)" 
                                              Margin="0,0,5,0" Padding="8,5" VerticalContentAlignment="Center"
                                              IsEditable="True"
                                              Text="Select">
                                                    <ComboBox.ItemTemplate>
                                                        <DataTemplate>
                                                            <CheckBox IsChecked="{Binding IsSelected, Mode=TwoWay}"
                                                          Checked="MsgIdCheckBox_Checked"
                                                          Unchecked="MsgIdCheckBox_Unchecked"
                                                          FontSize="14">
                                                                <TextBlock Text="{Binding Value}"/>
                                                            </CheckBox>
                                                        </DataTemplate>
                                                    </ComboBox.ItemTemplate>
                                                </ComboBox>
                                                <Button Name="ClearEventMsgIdFilterButton" Content="🔄" Width="28" Height="30" FontSize="13"
                                            Click="ClearEventMsgIdFilterButton_Click" ToolTip="Clear EVENT MsgId filter" Margin="3,0"/>
                                                <TextBlock Text="Content:" VerticalAlignment="Center" FontSize="14" FontWeight="SemiBold" Margin="5,0,3,0"/>
                                                <TextBox Name="EventContentFilterTextBox" Width="150" Height="32" FontSize="14" 
                                             ToolTip="Filter EVENT logs by content keywords" 
                                             TextChanged="EventContentFilterTextBox_TextChanged" Padding="8,5" VerticalContentAlignment="Center"
                                             Margin="0,0,5,0"/>
                                                <Button Name="ClearEventContentFilterButton" Content="🔄" Width="28" Height="30" FontSize="13"
                                            Click="ClearEventContentFilterButton_Click" ToolTip="Clear EVENT Content filter" Margin="3,0"/>
                                            </StackPanel>
                                        </GroupBox.Header>
                                        <DataGrid Name="eventLogDataGrid" 
                                      AutoGenerateColumns="False"
                                      GridLinesVisibility="All"
                                      HeadersVisibility="Column"
                                      SelectionMode="Extended"
                                      SelectionUnit="FullRow"
                                      CanUserReorderColumns="False"
                                      CanUserSortColumns="True"
                                      CanUserResizeRows="True"
                                      IsReadOnly="False"
                                      VirtualizingPanel.IsVirtualizing="True"
                                      VirtualizingPanel.VirtualizationMode="Recycling"
                                      FontFamily="Consolas"
                                      FontSize="11"
                                      AlternatingRowBackground="WhiteSmoke"
                                      RowBackground="White"
                                      Margin="2"
                                      ScrollViewer.HorizontalScrollBarVisibility="Auto"
                                      ScrollViewer.VerticalScrollBarVisibility="Auto">

                                            <DataGrid.Columns>
                                                <DataGridTextColumn Header="Line" Binding="{Binding LineNumber}" Width="50" IsReadOnly="True"/>
                                                <DataGridTextColumn Header="Time" Binding="{Binding Timestamp}" Width="70" IsReadOnly="False"/>
                                                <DataGridTextColumn Header="MsgId" Binding="{Binding MsgId}" Width="80" IsReadOnly="False"/>
                                                <DataGridTextColumn Header="BARCODE/LOT" Binding="{Binding BARCODE_LOT}" Width="150" IsReadOnly="False"/>
                                                <DataGridTextColumn Header="ProcId" Binding="{Binding ProcId}" Width="100" IsReadOnly="False" Visibility="Collapsed"/>
                                                <DataGridTextColumn Header="Content" Binding="{Binding Content}" Width="500" IsReadOnly="False" CellStyle="{StaticResource ContentCellStyle}"/>
                                            </DataGrid.Columns>
                                        </DataGrid>
                                    </GroupBox>

                                    <!-- Vertical GridSplitter -->
                                    <GridSplitter Grid.Column="1" Grid.Row="0" Grid.RowSpan="3"
                                      HorizontalAlignment="Stretch"
                                      VerticalAlignment="Stretch"
                                      Width="5"
                                      Background="#FF6B6B6B"
                                      ShowsPreview="True"
                                      ResizeBehavior="PreviousAndNext"
                                      Cursor="SizeWE"/>

                                    <!-- DEBUG DataGrid -->
                                    <GroupBox Grid.Column="0" Grid.Row="2" Margin="5" Name="DebugGroupBox_FourPanel">
                                        <GroupBox.Header>
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock Text="🔧 DEBUG" VerticalAlignment="Center" FontWeight="Bold" FontSize="12" Foreground="DarkOrange" Margin="0,0,10,0"/>
                                                <TextBlock Text="Content:" VerticalAlignment="Center" FontSize="14" FontWeight="SemiBold" Margin="0,0,3,0"/>
                                                <TextBox Name="DebugContentFilterTextBox" Width="200" Height="32" FontSize="14" 
                                             ToolTip="Filter DEBUG logs by content keywords" 
                                             TextChanged="DebugContentFilterTextBox_TextChanged" Padding="8,5" VerticalContentAlignment="Center"
                                             Margin="0,0,5,0"/>
                                                <Button Name="ClearDebugFilterButton" Content="🔄" Width="28" Height="30" FontSize="13"
                                            Click="ClearDebugFilterButton_Click" ToolTip="Clear DEBUG filter" Margin="3,0"/>
                                            </StackPanel>
                                        </GroupBox.Header>
                                        <DataGrid Name="debugLogDataGrid" 
                                      AutoGenerateColumns="False"
                                      GridLinesVisibility="All"
                                      HeadersVisibility="Column"
                                      SelectionMode="Extended"
                                      SelectionUnit="FullRow"
                                      CanUserReorderColumns="False"
                                      CanUserSortColumns="True"
                                      CanUserResizeRows="True"
                                      IsReadOnly="False"
                                      VirtualizingPanel.IsVirtualizing="True"
                                      VirtualizingPanel.VirtualizationMode="Recycling"
                                      FontFamily="Consolas"
                                      FontSize="11"
                                      AlternatingRowBackground="WhiteSmoke"
                                      RowBackground="White"
                                      Margin="2"
                                      ScrollViewer.HorizontalScrollBarVisibility="Auto"
                                      ScrollViewer.VerticalScrollBarVisibility="Auto">

                                            <DataGrid.Columns>
                                                <DataGridTextColumn Header="Line" Binding="{Binding LineNumber}" Width="50" IsReadOnly="True"/>
                                                <DataGridTextColumn Header="Time" Binding="{Binding Timestamp}" Width="70" IsReadOnly="False"/>
                                                <DataGridTextColumn Header="Content" Binding="{Binding Content}" Width="800" IsReadOnly="False" CellStyle="{StaticResource ContentCellStyle}"/>
                                            </DataGrid.Columns>
                                        </DataGrid>
                                    </GroupBox>

                                    <!-- Horizontal GridSplitter between top and bottom rows -->
                                    <GridSplitter Grid.Column="0" Grid.Row="1" Grid.ColumnSpan="3"
                                      HorizontalAlignment="Stretch"
                                      VerticalAlignment="Stretch"
                                      Height="5"
                                      Background="#FF6B6B6B"
                                      ShowsPreview="True"
                                      ResizeBehavior="PreviousAndNext"
                                      Cursor="SizeNS"/>

                                    <!-- EXCEPTION DataGrid -->
                                    <GroupBox Grid.Column="2" Grid.Row="2" Margin="5" Name="ExceptionGroupBox_FourPanel">
                                        <GroupBox.Header>
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock Text="⚠️ EXCEPTION" VerticalAlignment="Center" FontWeight="Bold" FontSize="12" Foreground="DarkRed" Margin="0,0,10,0"/>
                                                <TextBlock Text="Business:" VerticalAlignment="Center" FontSize="14" FontWeight="SemiBold" Margin="0,0,3,0"/>
                                                <ComboBox Name="ExceptionBusinessFilterComboBox" Width="200" Height="32" FontSize="14" 
                                              ToolTip="Filter EXCEPTION logs by business name (Multi-select with checkboxes)" 
                                              Margin="0,0,5,0" Padding="8,5" VerticalContentAlignment="Center"
                                              IsEditable="True"
                                              Text="Select">
                                                    <ComboBox.ItemTemplate>
                                                        <DataTemplate>
                                                            <CheckBox IsChecked="{Binding IsSelected, Mode=TwoWay}"
                                                          Checked="ExceptionBusinessCheckBox_Checked"
                                                          Unchecked="ExceptionBusinessCheckBox_Unchecked"
                                                          FontSize="14">
                                                                <TextBlock Text="{Binding Value}"/>
                                                            </CheckBox>
                                                        </DataTemplate>
                                                    </ComboBox.ItemTemplate>
                                                </ComboBox>
                                                <Button Name="ClearExceptionBusinessFilterButton" Content="🔄" Width="28" Height="30" FontSize="13"
                                            Click="ClearExceptionBusinessFilterButton_Click" ToolTip="Clear EXCEPTION Business filter" Margin="3,0"/>
                                                <TextBlock Text="Content:" VerticalAlignment="Center" FontSize="14" FontWeight="SemiBold" Margin="5,0,3,0"/>
                                                <TextBox Name="ExceptionContentFilterTextBox" Width="150" Height="32" FontSize="14" 
                                             ToolTip="Filter EXCEPTION logs by content keywords" 
                                             TextChanged="ExceptionContentFilterTextBox_TextChanged" Padding="8,5" VerticalContentAlignment="Center"
                                             Margin="0,0,5,0"/>
                                                <Button Name="ClearExceptionContentFilterButton" Content="🔄" Width="28" Height="30" FontSize="13"
                                            Click="ClearExceptionContentFilterButton_Click" ToolTip="Clear EXCEPTION Content filter" Margin="3,0"/>
                                            </StackPanel>
                                        </GroupBox.Header>
                                        <DataGrid Name="exceptionLogDataGrid" 
                                      AutoGenerateColumns="False"
                                      GridLinesVisibility="All"
                                      HeadersVisibility="Column"
                                      SelectionMode="Extended"
                                      SelectionUnit="FullRow"
                                      CanUserReorderColumns="False"
                                      CanUserSortColumns="True"
                                      CanUserResizeRows="True"
                                      IsReadOnly="False"
                                      VirtualizingPanel.IsVirtualizing="True"
                                      VirtualizingPanel.VirtualizationMode="Recycling"
                                      FontFamily="Consolas"
                                      FontSize="11"
                                      AlternatingRowBackground="WhiteSmoke"
                                      RowBackground="White"
                                      Margin="2"
                                      ScrollViewer.HorizontalScrollBarVisibility="Auto"
                                      ScrollViewer.VerticalScrollBarVisibility="Auto">

                                            <DataGrid.Columns>
                                                <DataGridTextColumn Header="Line" Binding="{Binding LineNumber}" Width="50" IsReadOnly="True"/>
                                                <DataGridTextColumn Header="Time" Binding="{Binding Timestamp}" Width="70" IsReadOnly="False"/>
                                                <DataGridTextColumn Header="Business" Binding="{Binding BusinessName}" Width="250" IsReadOnly="False"/>
                                                <DataGridTextColumn Header="Content" Binding="{Binding Content}" Width="500" IsReadOnly="False" CellStyle="{StaticResource ContentCellStyle}"/>
                                                <DataGridTextColumn Header="Error Description" Binding="{Binding ErrorDescription}" Width="300" IsReadOnly="False"/>
                                            </DataGrid.Columns>
                                        </DataGrid>
                                    </GroupBox>
                                </Grid>

                                <!-- 4개의 탭 DataGrid Area -->
                                <TabControl Grid.Row="1" Name="DataGridTabPanel" Visibility="Collapsed" Margin="2">
                                    <TabItem Header="DATA">
                                        <ContentControl Name="DataGridHost_DATA_Tab" />
                                    </TabItem>
                                    <TabItem Header="EVENT">
                                        <ContentControl Name="DataGridHost_EVENT_Tab" />
                                    </TabItem>
                                    <TabItem Header="DEBUG">
                                        <ContentControl Name="DataGridHost_DEBUG_Tab" />
                                    </TabItem>
                                    <TabItem Header="EXCEPTION">
                                        <ContentControl Name="DataGridHost_EXCEPTION_Tab" />
                                    </TabItem>
                                </TabControl>
                            </Grid>
                        </TabItem>

                        <!-- 🔗 NEW TAB: 통합 로그 (Unified Log) -->
                        <TabItem Header="🔗 통합 로그" Name="UnifiedLogTab">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>

                                <!-- Toolbar -->
                                <Border Grid.Row="0" Background="AliceBlue" BorderBrush="SteelBlue" BorderThickness="0,0,0,1" Padding="10,5">
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>

                                        <!-- Row 1: Font Size Controls -->
                                        <StackPanel Grid.Row="0" Orientation="Horizontal" VerticalAlignment="Center" Margin="0,0,0,5">
                                            <Label Content="Font Size:" VerticalAlignment="Center" FontWeight="SemiBold" Margin="0,0,6,0"/>
                                            <TextBox Name="UnifiedLogFontSizeTextBox" Width="42" Height="26" Text="11" TextAlignment="Center" VerticalContentAlignment="Center" IsReadOnly="True" Margin="0,0,6,0"/>
                                            <Button Name="UnifiedLogFontSizeDecreaseButton" Content="-" Width="30" Height="26" Margin="0,0,4,0" Click="UnifiedLogFontSizeDecrease_Click" ToolTip="Decrease Font Size"/>
                                            <Button Name="UnifiedLogFontSizeIncreaseButton" Content="+" Width="30" Height="26" Margin="0,0,12,0" Click="UnifiedLogFontSizeIncrease_Click" ToolTip="Increase Font Size"/>

                                            <Separator Margin="10,0"/>

                                            <Button Name="ToggleUnifiedContentButton" Content="콘텐츠 닫기" Width="100" Height="26" Margin="0,0,8,0" 
                                        Click="ToggleUnifiedContentButton_Click" ToolTip="Toggle Content column visibility"
                                        Background="LightSteelBlue" Foreground="DarkBlue"/>

                                            <Separator Margin="10,0"/>

                                            <!-- Export Button -->
                                            <Button Name="ExportUnifiedLogButton" Content="📥 엑셀 다운로드" Width="120" Height="26" 
                                        Click="ExportUnifiedLogButton_Click" ToolTip="Export unified log to Excel"
                                        Background="LightGreen" Foreground="DarkBlue" Margin="0,0,10,0"/>

                                            <!-- Status -->
                                            <TextBlock Name="UnifiedLogStatusText" Text="통합 로그 준비 완료" 
                                           VerticalAlignment="Center" FontWeight="SemiBold" Foreground="DarkBlue" FontSize="12"/>
                                        </StackPanel>

                                        <!-- Row 2: Filters -->
                                        <StackPanel Grid.Row="1" Orientation="Horizontal" VerticalAlignment="Center">
                                            <!-- LogType Filter -->
                                            <TextBlock Text="LogType:" VerticalAlignment="Center" FontSize="14" FontWeight="SemiBold" Margin="0,0,5,0"/>
                                            <ComboBox Name="UnifiedLogTypeFilterComboBox" Width="120" Height="30" FontSize="14" 
                                          ToolTip="Filter by log type" 
                                          SelectionChanged="UnifiedLogTypeFilterComboBox_SelectionChanged"
                                          Margin="0,0,10,0">
                                                <ComboBoxItem Content="전체" Tag="ALL" IsSelected="True"/>
                                                <ComboBoxItem Content="DATA" Tag="DATA"/>
                                                <ComboBoxItem Content="EVENT" Tag="EVENT"/>
                                                <ComboBoxItem Content="DEBUG" Tag="DEBUG"/>
                                                <ComboBoxItem Content="EXCEPTION" Tag="EXCEPTION"/>
                                            </ComboBox>

                                            <Separator Margin="5,0"/>

                                            <!-- Business/MsgId Filter (Multi-select) -->
                                            <TextBlock Text="Business/MsgId:" VerticalAlignment="Center" FontSize="14" FontWeight="SemiBold" Margin="5,0,5,0"/>
                                            <ComboBox Name="UnifiedBusinessMsgIdFilterComboBox" Width="250" Height="32" FontSize="14" 
                                          ToolTip="Filter by Business or MsgId (Multi-select with checkboxes)" 
                                          Margin="0,0,5,0" Padding="8,5" VerticalContentAlignment="Center"
                                          IsEditable="True"
                                          Text="Select">
                                                <ComboBox.ItemTemplate>
                                                    <DataTemplate>
                                                        <CheckBox IsChecked="{Binding IsSelected, Mode=TwoWay}"
                                                      Checked="UnifiedBusinessMsgIdCheckBox_Checked"
                                                      Unchecked="UnifiedBusinessMsgIdCheckBox_Unchecked"
                                                      FontSize="14">
                                                            <TextBlock Text="{Binding Value}"/>
                                                        </CheckBox>
                                                    </DataTemplate>
                                                </ComboBox.ItemTemplate>
                                            </ComboBox>
                                            <Button Name="ClearUnifiedBusinessMsgIdFilterButton" Content="🔄" Width="28" Height="30" FontSize="13"
                                        Click="ClearUnifiedBusinessMsgIdFilterButton_Click" ToolTip="Clear Business/MsgId filter" Margin="3,0,10,0"/>

                                            <Separator Margin="5,0"/>

                                            <!-- Content Filter -->
                                            <TextBlock Text="Content:" VerticalAlignment="Center" FontSize="14" FontWeight="SemiBold" Margin="5,0,5,0"/>
                                            <TextBox Name="UnifiedContentFilterTextBox" Width="200" Height="30" FontSize="14" 
                                         ToolTip="Filter by content keywords" 
                                         TextChanged="UnifiedContentFilterTextBox_TextChanged"
                                         Padding="5" VerticalContentAlignment="Center"
                                         Margin="0,0,5,0"/>
                                            <Button Name="ClearUnifiedContentFilterButton" Content="🔄" Width="28" Height="30" FontSize="13"
                                        Click="ClearUnifiedContentFilterButton_Click" ToolTip="Clear Content filter" Margin="3,0,10,0"/>

                                            <Separator Margin="5,0"/>

                                            <!-- Clear All Filters Button -->
                                            <Button Name="ClearUnifiedFiltersButton" Content="🔄 전체 필터 초기화" Width="140" Height="30" 
                                        Click="ClearUnifiedFiltersButton_Click" ToolTip="Clear all unified log filters"
                                        Background="LightYellow" Foreground="DarkOrange" Margin="5,0"/>
                                        </StackPanel>
                                    </Grid>
                                </Border>

                                <!-- Unified DataGrid -->
                                <DataGrid Grid.Row="1" Name="unifiedLogDataGrid"
                              AutoGenerateColumns="False"
                              GridLinesVisibility="All"
                              HeadersVisibility="Column"
                              SelectionMode="Extended"
                              SelectionUnit="FullRow"
                              CanUserReorderColumns="False"
                              CanUserSortColumns="True"
                              CanUserResizeRows="True"
                              IsReadOnly="False"
                              VirtualizingPanel.IsVirtualizing="True"
                              VirtualizingPanel.VirtualizationMode="Recycling"
                              FontFamily="Consolas"
                              FontSize="11"
                              AlternatingRowBackground="WhiteSmoke"
                              RowBackground="White"
                              Margin="5"
                              ScrollViewer.HorizontalScrollBarVisibility="Auto"
                              ScrollViewer.VerticalScrollBarVisibility="Auto">

                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="Time" Binding="{Binding Timestamp}" Width="70" IsReadOnly="False"/>
                                        <DataGridTextColumn Header="LogType" Binding="{Binding LogLevel}" Width="90" IsReadOnly="False"/>
                                        <DataGridTextColumn Header="Business" Binding="{Binding BusinessName}" Width="250" IsReadOnly="False"/>
                                        <DataGridTextColumn Header="MsgId" Binding="{Binding MsgId}" Width="80" IsReadOnly="False"/>
                                        <DataGridTextColumn Header="ExecTime" Binding="{Binding ExecTime}" Width="90" IsReadOnly="False"/>
                                        <DataGridTextColumn Header="TxnId" Binding="{Binding TxnId}" Width="200" IsReadOnly="False"/>
                                        <DataGridTextColumn Header="Content" Binding="{Binding Content}" Width="500" IsReadOnly="False" CellStyle="{StaticResource ContentCellStyle}"/>
                                    </DataGrid.Columns>
                                </DataGrid>
                            </Grid>
                        </TabItem>

                        <!-- Clipboard Pad (moved to be the 3rd tab) -->
                        <TabItem Header="📎 복사 / 붙여넣기" Name="ClipboardTab">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>

                                <!-- Toolbar -->
                                <Border Grid.Row="0" Background="LightGray" BorderBrush="Gray" BorderThickness="0,0,0,1" Padding="8,6">
                                    <StackPanel Orientation="Horizontal">
                                        <Button Name="ClipboardClearButton" Content="🧹 초기화" Width="80" Height="26" Margin="0,0,6,0" Click="ClipboardClearButton_Click" ToolTip="Clear all clipboard boxes"/>
                                        <Separator Margin="10,0"/>
                                        <TextBlock VerticalAlignment="Center" FontStyle="Italic" Foreground="Gray">9 quick text slots</TextBlock>
                                    </StackPanel>
                                </Border>

                                <!-- 3x3 grid of TextBoxes -->
                                <Grid Grid.Row="1" Margin="8">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="*"/>
                                        <RowDefinition Height="*"/>
                                        <RowDefinition Height="*"/>
                                    </Grid.RowDefinitions>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>

                                    <!-- 9 multiline textboxes -->
                                    <TextBox Grid.Row="0" Grid.Column="0" Name="ClipboardBox1" Margin="4" FontFamily="Consolas" FontSize="12"
                                 AcceptsReturn="True" TextWrapping="Wrap" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto" MinHeight="60"/>
                                    <TextBox Grid.Row="0" Grid.Column="1" Name="ClipboardBox2" Margin="4" FontFamily="Consolas" FontSize="12"
                                 AcceptsReturn="True" TextWrapping="Wrap" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto" MinHeight="60"/>
                                    <TextBox Grid.Row="0" Grid.Column="2" Name="ClipboardBox3" Margin="4" FontFamily="Consolas" FontSize="12"
                                 AcceptsReturn="True" TextWrapping="Wrap" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto" MinHeight="60"/>

                                    <TextBox Grid.Row="1" Grid.Column="0" Name="ClipboardBox4" Margin="4" FontFamily="Consolas" FontSize="12"
                                 AcceptsReturn="True" TextWrapping="Wrap" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto" MinHeight="60"/>
                                    <TextBox Grid.Row="1" Grid.Column="1" Name="ClipboardBox5" Margin="4" FontFamily="Consolas" FontSize="12"
                                 AcceptsReturn="True" TextWrapping="Wrap" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto" MinHeight="60"/>
                                    <TextBox Grid.Row="1" Grid.Column="2" Name="ClipboardBox6" Margin="4" FontFamily="Consolas" FontSize="12"
                                 AcceptsReturn="True" TextWrapping="Wrap" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto" MinHeight="60"/>

                                    <TextBox Grid.Row="2" Grid.Column="0" Name="ClipboardBox7" Margin="4" FontFamily="Consolas" FontSize="12"
                                 AcceptsReturn="True" TextWrapping="Wrap" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto" MinHeight="60"/>
                                    <TextBox Grid.Row="2" Grid.Column="1" Name="ClipboardBox8" Margin="4" FontFamily="Consolas" FontSize="12"
                                 AcceptsReturn="True" TextWrapping="Wrap" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto" MinHeight="60"/>
                                    <TextBox Grid.Row="2" Grid.Column="2" Name="ClipboardBox9" Margin="4" FontFamily="Consolas" FontSize="12"
                                 AcceptsReturn="True" TextWrapping="Wrap" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto" MinHeight="60"/>
                                </Grid>
                            </Grid>
                        </TabItem>

                        <!-- Tab: 빨간 비즈니스 관리 -->
                        <TabItem Header="🔴 빨간 비즈니스" Name="RedBusinessTab">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>

                                <!-- Toolbar -->
                                <Border Grid.Row="0" Background="LightCoral" BorderBrush="DarkRed" BorderThickness="0,0,0,1" Padding="8,6">
                                    <StackPanel Orientation="Horizontal">
                                        <Button Name="AddRedBusinessButton" Content="➕ 추가" Width="70" Height="26" Margin="0,0,6,0" Click="AddRedBusinessButton_Click" ToolTip="Add new red business item"/>
                                        <Button Name="DeleteRedBusinessButton" Content="➖ 삭제" Width="70" Height="26" Margin="0,0,6,0" Click="DeleteRedBusinessButton_Click" ToolTip="Delete selected item"/>
                                        <Button Name="SaveRedBusinessListButton" Content="💾 저장" Width="70" Height="26" Margin="0,0,6,0" Click="SaveRedBusinessListButton_Click" ToolTip="Save red business list"/>
                                        <Button Name="LoadRedBusinessListButton" Content="📂 불러오기" Width="90" Height="26" Margin="0,0,10,0" Click="LoadRedBusinessListButton_Click" ToolTip="Load red business list from file"/>
                                        <Separator Margin="10,0"/>
                                        <TextBlock VerticalAlignment="Center" FontStyle="Italic" Foreground="DarkRed" Text="빨간색으로 표시할 비즈니스 목록을 관리합니다"/>
                                    </StackPanel>
                                </Border>

                                <!-- DataGrid -->
                                <DataGrid Grid.Row="1" Name="redBusinessDataGrid" 
                              AutoGenerateColumns="False"
                              CanUserAddRows="False"
                              SelectionMode="Single"
                              GridLinesVisibility="All"
                              Margin="5">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="Index" Binding="{Binding Index}" Width="60" IsReadOnly="True"/>
                                        <DataGridTextColumn Header="Business Name" Binding="{Binding BusinessName}" Width="300" IsReadOnly="False"/>
                                        <DataGridComboBoxColumn Header="Color" x:Name="ColorColumn" SelectedItemBinding="{Binding Color}" Width="100"/>
                                        <DataGridCheckBoxColumn Header="Enabled" Binding="{Binding IsEnabled}" Width="80"/>
                                        <DataGridTextColumn Header="Description" Binding="{Binding Description}" Width="*" IsReadOnly="False"/>
                                    </DataGrid.Columns>
                                </DataGrid>
                            </Grid>
                        </TabItem>

                        <!-- Tab: exec.Time 분석 -->
                        <TabItem Header="⏱️ exec.Time" Name="ExecTimeTab">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>

                                <!-- Toolbar -->
                                <Border Grid.Row="0" Background="LightYellow" BorderBrush="Orange" BorderThickness="0,0,0,1" Padding="8,6">
                                    <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                        <Label Content="임계값 (초):" VerticalAlignment="Center" FontWeight="SemiBold"/>
                                        <TextBox Name="execTimeFilterTextBox" Width="60" Height="26" Margin="5,0" Text="0.5" TextAlignment="Center" VerticalContentAlignment="Center"/>
                                        <Button Name="ApplyExecTimeFilterButton" Content="⏱ 필터 적용" Width="100" Height="26" Margin="5,0" Click="ApplyExecTimeFilterButton_Click" ToolTip="Apply exec.Time filter" Background="LightGreen"/>
                                        <Button Name="ClearExecTimeFilterButton" Content="🔄 초기화" Width="80" Height="26" Margin="5,0" Click="ClearExecTimeFilterButton_Click" ToolTip="Clear filter" Background="LightCoral"/>
                                        <Button Name="LoadExecTimeAnalysisButton" Content="📊 분석 로드" Width="100" Height="26" Margin="5,0" Click="LoadExecTimeAnalysisButton_Click" ToolTip="Load exec.Time analysis" Background="LightBlue"/>
                                        <Separator Margin="10,0"/>
                                        <TextBlock Name="ExecTimeStatusText" Text="exec.Time Analysis Ready" VerticalAlignment="Center" FontWeight="SemiBold" Foreground="DarkBlue"/>
                                    </StackPanel>
                                </Border>

                                <!-- DataGrid -->
                                <DataGrid Grid.Row="1" Name="execTimeDataGrid" 
                              AutoGenerateColumns="False"
                              GridLinesVisibility="All"
                              HeadersVisibility="Column"
                              SelectionMode="Extended"
                              SelectionUnit="FullRow"
                              CanUserReorderColumns="False"
                              CanUserSortColumns="True"
                              IsReadOnly="False"
                              VirtualizingPanel.IsVirtualizing="True"
                              VirtualizingPanel.VirtualizationMode="Recycling"
                              FontFamily="Consolas"
                              FontSize="11"
                              AlternatingRowBackground="WhiteSmoke"
                              RowBackground="White"
                              Margin="5"
                              ScrollViewer.HorizontalScrollBarVisibility="Auto"
                              ScrollViewer.VerticalScrollBarVisibility="Auto">

                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="Line" Binding="{Binding LineNumber}" Width="50" IsReadOnly="True"/>
                                        <DataGridTextColumn Header="Time" Binding="{Binding Timestamp}" Width="70" IsReadOnly="False"/>
                                        <DataGridTextColumn Header="Business" Binding="{Binding BusinessName}" Width="250" IsReadOnly="False"/>
                                        <DataGridTextColumn Header="ExecTime" Binding="{Binding ExecTime}" Width="90" IsReadOnly="False"/>
                                        <DataGridTextColumn Header="TxnId" Binding="{Binding TxnId}" Width="200" IsReadOnly="False"/>
                                        <DataGridTextColumn Header="Content" Binding="{Binding Content}" Width="500" IsReadOnly="False" CellStyle="{StaticResource ContentCellStyle}"/>
                                    </DataGrid.Columns>
                                </DataGrid>
                            </Grid>
                        </TabItem>
                    </TabControl>
                </Grid>
            </TabItem>
            <TabItem Header="Setting" Name="mainSettingTb">
                <views:SettingsControl x:Name="settingsControl" />
            </TabItem>
        </TabControl>
    </Grid>
    
</Window>
